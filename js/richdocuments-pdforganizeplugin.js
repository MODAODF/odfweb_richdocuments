(()=>{function e(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function n(t){return function(){var n=this,r=arguments;return new Promise((function(i,o){var s=t.apply(n,r);function a(t){e(s,i,o,a,c,"next",t)}function c(t){e(s,i,o,a,c,"throw",t)}a(void 0)}))}}!function(e){e.FilesPdfEditor=e.FilesPdfEditor||{},e.FilesPdfEditor.PreviewPlugin={attach:function(e){["files","files.public"].indexOf(e.id)<0||this._extendFileActions(e)},_extendFileActions:function(e){for(var r=0,i=["application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"];r<i.length;r++){var o=i[r];e.fileActions.registerAction({name:"_toPDF",displayName:t("richdocuments","Save as PDF"),mime:o,permissions:OC.PERMISSION_READ,icon:OC.imagePath("richdocuments","topdf"),actionHandler:s})}function s(e,t){return a.apply(this,arguments)}function a(){return(a=n(regeneratorRuntime.mark((function n(r,i){var o,s,a,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!=(i.fileList.dirInfo.permissions&OC.PERMISSION_CREATE)&&"0"!==i.fileList.$el.find("#free_space").val()){n.next=4;break}return OC.dialogs.alert(t("files","You donâ€™t have permission to upload or create files here"),t("richdocuments","Error")),n.abrupt("return");case 4:return n.prev=4,n.next=7,fetch(OC.generateUrl("/apps/richdocuments/convert/check"));case 7:if((o=n.sent).ok){n.next=13;break}return n.next=11,o.text();case 11:throw n.sent;case 13:n.next=19;break;case 15:return n.prev=15,n.t0=n.catch(4),OC.dialogs.alert(t("The [convet-to] is not working or unavailable, please contact the system administrator"),t("richdocuments","Error")),n.abrupt("return");case 19:(s=e._operationProgressBar).showProgressBar(!1),s.setProgressBarValue(0),s.setProgressBarText(t("richdocuments","Save as PDF"),null,null),s.hideCancelButton(),a=i.$file?i.$file.attr("data-id"):i.fileId,c=i.$file?i.$file.attr("data-path"):i.fileList.getCurrentDirectory(),l=OC.generateUrl("/apps/richdocuments/convert/pdf"),l+="?fileid="+a,l+="&destination="+c,"files.public"===i.fileList.id&&(l+="&sharingToken="+$("#sharingToken").val()),fetch(l).then((function(n){n.ok||n.text().then((function(e){OC.dialogs.alert(t("richdocuments",e),t("richdocuments","Error"))})),s.setProgressBarText(t("richdocuments",n.ok?"Finished file convert":"Error"),null,null),setTimeout((function(){s.hideProgressBar(),s.setProgressBarText("")}),1500),e.reload()}));case 31:case"end":return n.stop()}}),n,null,[[4,15]])})))).apply(this,arguments)}}}}(OCA),OC.Plugins.register("OCA.Files.FileList",OCA.FilesPdfEditor.PreviewPlugin)})();
//# sourceMappingURL=richdocuments-pdforganizeplugin.js.map?v=cca19bedcc184989d6c7